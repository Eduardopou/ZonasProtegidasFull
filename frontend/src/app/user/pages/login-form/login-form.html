<app-header-page></app-header-page>
<app-back-button [floating]="true"></app-back-button>

<div class="login-container">
  <form [formGroup]="login_user_form" (ngSubmit)="post_user()">
    <h1>Iniciar Sesión</h1>

    <div class="input-group">
      <label for="email">Correo</label>
      <input formControlName="email" type="email" id="email" placeholder="Ingresa tu correo" required
             [attr.aria-invalid]="login_user_form.get('email')?.invalid && login_user_form.get('email')?.touched">
      
      <!-- Mensajes de error de email -->
      @if (login_user_form.get('email')?.invalid && (login_user_form.get('email')?.dirty || login_user_form.get('email')?.touched)) {
        <div class="error-message-field">
          @if (login_user_form.get('email')?.hasError('required')) {
            <span>El correo es obligatorio.</span>
          }
          @if (login_user_form.get('email')?.hasError('email')) {
            <span>Formato de correo incorrecto. (Ej: tu@correo.com)</span>
          }
        </div>
      }
    </div>

    <div class="input-group">
      <label for="password">Contraseña</label>
      <input formControlName="password" type="password" id="password" placeholder="Ingresa tu contraseña" required
             [attr.aria-invalid]="login_user_form.get('password')?.invalid && login_user_form.get('password')?.touched">
      
      <!-- Mensajes de error de contraseña -->
      @if (login_user_form.get('password')?.invalid && (login_user_form.get('password')?.dirty || login_user_form.get('password')?.touched)) {
        <div class="error-message-field">
          @if (login_user_form.get('password')?.hasError('required')) {
            <span>La contraseña es obligatoria.</span>
          }
          @if (login_user_form.get('password')?.hasError('minlength')) {
            <span>Contraseña demasiado corta. Debe incluir 8 caracteres y un número.</span>
          }
        </div>
      }
    </div>

    <button class="login-btn" type="submit">Entrar</button>
  </form>

  <div class="extra-links">
    <p>¿Olvidaste tu contraseña? <a (click)="onForgotPassword($event)">Recuperar contraseña</a></p>
    <p>¿No tienes cuenta? 
      <button type="button" class="link-style-button" (click)="login_redirect($event)">
        Crear cuenta
      </button>
    </p>
  </div>

  <div *ngIf="errorMessage" class="error-message" role="alert">
    {{ errorMessage }}
  </div>
</div>
